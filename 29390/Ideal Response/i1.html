<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Scene</title>
    <style>
        *,
        *::after,
        *::before {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            outline: none;
        }

        body {
            overflow: hidden;
            background-color: #949494;
            cursor: grab;
        }

        .webgl {
            position: fixed;
            top: 0;
            left: 0;
        }
    </style>
</head>
<body>
    <canvas class="webgl"></canvas>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r124/three.min.js"></script>
    <script src="https://unpkg.com/three@0.126.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://unpkg.com/three@0.126.0/examples/js/controls/OrbitControls.js"></script>

    <script>
        const sizes = {
            width: window.innerWidth,
            height: window.innerHeight
        };

        let scene, camera, renderer, controls;

        // Initialize scene, camera, and renderer
        function init() {
            const canvas = document.querySelector('.webgl');

            scene = new THREE.Scene();

            // Camera setup
            camera = new THREE.PerspectiveCamera(10, sizes.width / sizes.height, 0.1, 100);
            camera.position.set(18, 8, 20);
            scene.add(camera);

            // Renderer setup
            renderer = new THREE.WebGLRenderer({ canvas: canvas, antialias: true, alpha: true });
            renderer.setSize(sizes.width, sizes.height);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            renderer.outputEncoding = THREE.sRGBEncoding;

            // Orbit Controls setup
            controls = new THREE.OrbitControls(camera, canvas);
            controls.enableDamping = true;
            controls.enableZoom = true;
            controls.enablePan = false;
            configureControls();

            // Handle window resize
            window.addEventListener('resize', onWindowResize);
        }

        // Configure orbit controls
        function configureControls() {
            controls.minDistance = 20;
            controls.maxDistance = 40;
            controls.minPolarAngle = Math.PI / 4;
            controls.maxPolarAngle = Math.PI / 2;
            controls.minAzimuthAngle = -Math.PI / 80;
            controls.maxAzimuthAngle = Math.PI / 2.5;
        }

        // Handle window resize
        function onWindowResize() {
            sizes.width = window.innerWidth;
            sizes.height = window.innerHeight;

            camera.aspect = sizes.width / sizes.height;
            camera.updateProjectionMatrix();
            renderer.setSize(sizes.width, sizes.height);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        }

        // Load textures and models
        function loadAssets() {
            const textureLoader = new THREE.TextureLoader();
            const bakedTexture = textureLoader.load('https://rawcdn.githack.com/ricardoolivaalonso/ThreeJS-Room05/ae27bdffd31dcc5cd5a919263f8f1c6874e05400/baked.jpg');
            bakedTexture.flipY = false;
            bakedTexture.encoding = THREE.sRGBEncoding;

            const bakedMaterial = new THREE.MeshBasicMaterial({
                map: bakedTexture,
                side: THREE.DoubleSide,
            });

            const loader = new THREE.GLTFLoader();
            loader.load('https://rawcdn.githack.com/ricardoolivaalonso/ThreeJS-Room05/ae27bdffd31dcc5cd5a919263f8f1c6874e05400/model.glb', 
                (gltf) => {
                    const model = gltf.scene;
                    model.traverse(child => child.material = bakedMaterial);
                    scene.add(model);
                },
                (xhr) => console.log((xhr.loaded / xhr.total * 100) + '% loaded')
            );
        }

        // Animate scene
        function animate() {
            controls.update();
            renderer.render(scene, camera);
            requestAnimationFrame(animate);
        }

        // Initialize and start the scene
        function start() {
            init();
            loadAssets();
            animate();
        }

        start();
    </script>
</body>
</html>
